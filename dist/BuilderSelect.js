import{joinOperations as e,operation as s}from"./services/OperationService.js";import{Builder as t}from"./Builder.js";import{isFalseable as i}from"./services/FalseableService.js";export class BuilderSelect extends t{select(...e){return this.internalColumn(...e)}selectAliased(...e){return this.internalColumnAliased(...e)}distinct(e=!0){return this.selectDistinct=e,this}from(...e){return this.internalTable(...e)}fromAliased(...e){return this.internalTableAliased(...e)}where(...e){return this.internalWhere(...e)}having(...e){for(let s of e)i(s)||this.havingExpressions.push(s);return this}limit(...e){return this.internalLimit(...e)}offset(...e){return this.internalOffset(...e)}groupBy(...e){for(let s of e)i(s)||this.groupByColumns.push(s);return this}orderBy(e,s,t){return this.orders.push({expression:e,direction:s,nulls:t}),this}getOperations(){let t=["SELECT "];return this.selectDistinct&&t.push("DISTINCT "),0===this.columnsOperations.length?t.push("TRUE "):t.push(...e(this.columnsOperations,", ",!1)," "),this.generateFromOperation(t),this.generateJoinOperations(t),this.generateWhereOperation(t),this.groupByColumns.length>0&&t.push("GROUP BY ",...e(this.groupByColumns.map(e=>s(e)),", ",!1)," "),this.havingExpressions.length>0&&t.push("HAVING ",...s({type:"AND",expressions:this.havingExpressions,includeParens:!1})," "),this.orders.length>0&&t.push("ORDER BY ",...e(this.orders.map(e=>[...s(e.expression),...e.direction?[` ${e.direction}`]:[],...e.nulls?[` ${e.nulls}`]:[]]),", ",!1)," "),this.generateLimitOperation(t),this.generateOffsetOperation(t),t}constructor(...e){super(...e),this.selectDistinct=!1,this.orders=[],this.groupByColumns=[],this.havingExpressions=[]}}